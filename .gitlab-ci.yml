variables:
  LC_ALL: C.UTF-8
  LANG: en_US.UTF-8
  LANGUAGE: en_US.UTF-8

stages:
  - build

build:
  stage: build
  image:
    name: gcr.io/kaniko-project/executor:debug
    entrypoint: [""]
  script:
    - echo "{\"auths\":{\"$CI_REGISTRY\":{\"username\":\"$CI_REGISTRY_USER\",\"password\":\"$CI_REGISTRY_PASSWORD\"}}}" > /kaniko/.docker/config.json
    - echo "-----BEGIN CERTIFICATE-----\nMIIFBTCCAu2gAwIBAgIBADANBgkqhkiG9w0BAQsFADBGMQwwCgYDVQQGEwNVU0Ex\nDzANBgNVBAoMBkdpdExhYjESMBAGA1UECwwJQ29udGFpbmVyMREwDwYDVQQDDAhS\nZWdpc3RyeTAeFw0xNzAxMjIyMzQ4MTRaFw0yNzAxMjAyMzQ4MTRaMEYxDDAKBgNV\nBAYTA1VTQTEPMA0GA1UECgwGR2l0TGFiMRIwEAYDVQQLDAlDb250YWluZXIxETAP\nBgNVBAMMCFJlZ2lzdHJ5MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA\nt5nzNqlt6RC1GyUwcav1qFqMVKQbihgCEdRjFl6gebP7T+oLkWSD2I1SDr9KU9xs\nzrfurN50pgkvzc5HQa+ZrS0nOAunEpA92Xp1HYR/TMaiR4eUo279/dnIBdpHsycA\nGyYHcGFRRvy6pgglw9d3d40J7BjAOuGU7qhmRv+ALBF3tVG1+Gr+6p9Dk5YxJ+pV\nKNQdqPJCmOgNTfXM3JMiWhBof72kBLl1KxRNxlaHmcah5S5W6r5HeXXJ1yjDaRuS\nFMnjsfb0IoyfwGSJpuNRTw22j8zUDU7lMuFXC9pat8Q1UzTd3NZR+rjdtQXfALjJ\nyRtGDguD8f9GvsTLi9kbanWzrXxedVQnG6mHNIRrXca2NnjMnD3bCjQuWMQuIea2\nqo5YL4GH+0HYpg/+xyrP9FheeA3bVs6ANk5YxRXEAO4ym98ctkVSNuRkjxrWBw2x\nl3RFAQWNIWifHVkXcB6+2NEDWwyn6JGbi/DqXX8QdPjqFXLlqNRuh6DBzez41Vnq\nDL+9yzW/LJU1MyFrH7PSSoPUSzFBmtn686JE1iLIXqhOA3sxsp3yHbGmLCjo8T3n\ntqNceK2Q0xtjbDcOCNMHFQV60b6pv6LOYjGneuJKYaHFL/kN9VH/zEqO/lsu7Jmg\nMzD5OHltkP+S70hX+0XKRLCKzX0lgvFB32b1F1QUQ9cCAwEAATANBgkqhkiG9w0B\nAQsFAAOCAgEAZ0vv/p3JH1V7gCmYRTZf36BkjJm4zdy4cEz0qCfDdBJRBQhmi8eQ\nnWXQU8RYqo6aLKQFusbzEaffhyokIp1b1njaElxIDc4AU8B2ljF3mbzDZWoruQaG\nVN2AS1GSXIXR2gSrofFAS66+Vr21Qh2yHyK6LoOYkXegj6aK4dGwIRHd0SwpEcL2\nuRFsuWgEiTet8VkZz56zGe4m9cM6Dhnyhe+SEGhOsx4hwbLbS1nIafp0+Cfw/YP2\nNskN6kFhz7yrM898n/sZbyoFtX+f+XZtRZu1My6McCRxyioN5KhdE5nMAsbkCG2M\nToOi1+u6oFsc8p6JroxP/3qozSAu9M6pa2JH+6xsemuXOat3cMbuhExuuFOqSxjx\neU4B5V+9TwYMGgwB6NZA2M6V1Ux7w/sAzwpYg62EBJeNIwURUDR1aHfzSokPlTOR\n5vgbsYTEAhvut9iv7XPIyNGamr1+i4wt7LjTXiaYYYoPyq+MsFjTk0sVg+Y0ep4D\nsAk9FtlRkWEo4ELLaASNGrswAcL0l5w8lzUaNH3ZdNDVX7wapK6ih69NxyoUXgAT\nKD3CJDYn4EsJt9hG7gXnrNfZoGfy0gsoYCYl57EW0YyZkfiWMikrePXphAm05vOq\nm2dX6Ui4nfbXHtTJdIYhpxpJ3/CNsCXN3Fmus0GF9YlsZFeUxPWHQ5I=\n-----END CERTIFICATE-----\n" >> /kaniko/ssl/certs/ca-certificates.crt
    - /kaniko/executor --context $CI_PROJECT_DIR --dockerfile $CI_PROJECT_DIR/Dockerfile --destination $CI_REGISTRY_IMAGE:$CI_COMMIT_TAG
